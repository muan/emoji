// Generated by CoffeeScript 1.8.0
var focusOnSearch;

$(document).on('emoji:ready', function() {
  var clip;
  $(".input-search").focus();
  $(".loading").remove();
  if (navigator.userAgent.match(/iPad|iPhone/i)) {
    return $(document).on('click', '.emoji-code', function() {
      this.selectionStart = 0;
      return this.selectionEnd = this.value.length;
    });
  } else {
    clip = new ZeroClipboard($("[data-clipboard-text]"), {
      moviePath: "/assets/zeroclipboard.swf"
    });
    clip.on("complete", function(_, args) {
      return $("<div class=alert></div>").text("Copied " + args.text).appendTo("body").fadeIn().delay(1000).fadeOut();
    });
    return $(".emoji-code").attr("readonly", "readonly");
  }
});

clearSearchField = function(){
  if($('.input-search').val()){
    $('.input-search').val('');
  }
}
focusOnSearch = function(e, clearField) {
  var t;
<<<<<<< HEAD

  if(!$('.input-search').is(':focus')){
=======
  if (e.keyCode === 191 && !$(".input-search:focus").length) {
>>>>>>> parent of 08057e9... Added Typing Delay For illusion of smoother experience
    $(".input-search").focus();
    
    //Don't clear the field when input is in focus
    if(clearField){
      clearSearchField();
    }
  }
  

  if (true) {
    t = $(".input-search").get(0);
    if (t.value.length) {
      t.selectionStart = 0;
      t.selectionEnd = t.value.length;
    }
    return true;
  }
};

$.getJSON('emojis.json', function(emojis) {
  var container, i;
  container = $('.emojis-container');
  i = 0;
  return $.each(emojis, function(name, keywords) {
    i++;
    container.append("<li class='result emoji-wrapper' data-clipboard-text=':" + name + ":'> <div class='emoji s_" + (name.replace(/\+/, '')) + "' title='" + name + "'>" + name + "</div> <input type='text' class='autofocus plain emoji-code' value=':" + name + ":' /> <span class='keywords'>" + name + " " + keywords + "</span> </li>");
    if (Object.keys(emojis).length === i) {
      return $(document).trigger('emoji:ready');
    }
  });
});

$(document).keydown(function(e) {
  var inputInFocus = $('.input-search').is(':focus');

  /*
    The check is to make sure we don't refocus multiple
    times.
    The focus function clears the text box, and so
    if we focus multiple times, the text box will 
    constantly be cleared and the user will not be
    able to type anything.
  */
  if(!inputInFocus){
    return focusOnSearch(e);
  }

});

$(document).on('keydown', '.emoji-wrapper input', function(e) {
  $(".input-search").blur();
  return focusOnSearch(e);
});

$(document).on('click', '[data-clipboard-text]', function() {
  return ga('send', 'event', 'copy', $(this).attr('data-clipboard-text'));
});

$(document).on('click', '.js-hide-text', function() {
  var showorhide;
  $('.emojis-container').toggleClass('hide-text');
  showorhide = $('.emojis-container').hasClass('hide-text') ? 'hide' : 'show';
  ga('send', 'event', 'toggle text', showorhide);
  return false;
});

$(document).on('click', '.js-clear-search, .mojigroup.active', function() {
  location.hash = "";
  return false;
});

$(document).on('click', '.js-contribute', function() {
  return ga('send', 'event', 'contribute', 'click');
});
